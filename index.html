<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>实时聊天室</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- 注册/登录界面 -->
        <div id="auth-container" class="auth-container">
            <div class="auth-box">
                <h1><i class="fas fa-comments"></i> 实时聊天室</h1>
                <p class="subtitle">一个IP只能注册一个账号 · 支持撤回、引用和删除消息</p>
                
                <div id="login-form">
                    <div class="form-group">
                        <label for="username">用户名</label>
                        <input type="text" id="username" placeholder="请输入用户名" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="password">密码</label>
                        <input type="password" id="password" placeholder="请输入密码">
                    </div>
                    <button id="login-btn" class="btn btn-primary">登录</button>
                    <p class="auth-switch">还没有账号？<a href="#" id="switch-to-register">点击注册</a></p>
                </div>
                
                <div id="register-form" style="display: none;">
                    <div class="form-group">
                        <label for="reg-username">用户名</label>
                        <input type="text" id="reg-username" placeholder="请输入用户名" autocomplete="off">
                    </div>
                    <div class="form-group">
                        <label for="reg-password">密码</label>
                        <input type="password" id="reg-password" placeholder="请输入密码">
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">确认密码</label>
                        <input type="password" id="confirm-password" placeholder="请再次输入密码">
                    </div>
                    <button id="register-btn" class="btn btn-primary">注册</button>
                    <p class="auth-switch">已有账号？<a href="#" id="switch-to-login">点击登录</a></p>
                </div>
                
                <div class="auth-notice">
                    <p><i class="fas fa-info-circle"></i> 注意：系统将记录您的IP地址，每个IP只能注册一个账号。</p>
                </div>
            </div>
        </div>

        <!-- 聊天主界面 -->
        <div id="chat-container" class="chat-container" style="display: none;">
            <header class="chat-header">
                <div class="header-left">
                    <h2><i class="fas fa-comments"></i> 聊天室</h2>
                    <div class="user-info">
                        <span id="current-user"></span>
                        <span class="online-count" id="online-count">0人在线</span>
                    </div>
                </div>
                <button id="logout-btn" class="btn btn-secondary">退出</button>
            </header>

            <div class="chat-main">
                <!-- 在线用户列表 -->
                <div class="users-panel">
                    <div class="panel-header">
                        <h3><i class="fas fa-users"></i> 在线用户 (<span id="users-count">0</span>)</h3>
                    </div>
                    <ul id="users-list" class="users-list">
                        <!-- 在线用户列表会动态生成 -->
                    </ul>
                </div>

                <!-- 聊天区域 -->
                <div class="chat-area">
                    <div class="messages-container">
                        <div id="messages" class="messages">
                            <!-- 消息会动态添加到这里 -->
                        </div>
                    </div>

                    <!-- 引用消息预览 -->
                    <div id="quote-preview" class="quote-preview" style="display: none;">
                        <div class="quote-content">
                            <span id="quote-text"></span>
                            <button id="cancel-quote" class="cancel-quote"><i class="fas fa-times"></i></button>
                        </div>
                    </div>

                    <!-- 消息输入区域 -->
                    <div class="message-input-container">
                        <div class="input-actions">
                            <button id="clear-input" class="btn-icon" title="清空输入"><i class="fas fa-eraser"></i></button>
                            <button id="toggle-emoji" class="btn-icon" title="表情"><i class="far fa-smile"></i></button>
                        </div>
                        <textarea id="message-input" placeholder="输入消息... (按Ctrl+Enter发送)" rows="2"></textarea>
                        <button id="send-btn" class="btn btn-primary">发送</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 表情选择器 -->
        <div id="emoji-picker" class="emoji-picker" style="display: none;">
            <div class="emoji-header">
                <h4>选择表情</h4>
                <button id="close-emoji" class="btn-icon"><i class="fas fa-times"></i></button>
            </div>
            <div class="emoji-list">
                <!-- 常用表情 -->
                <span class="emoji">😀</span>
                <span class="emoji">😁</span>
                <span class="emoji">😂</span>
                <span class="emoji">😊</span>
                <span class="emoji">😉</span>
                <span class="emoji">😍</span>
                <span class="emoji">😎</span>
                <span class="emoji">😜</span>
                <span class="emoji">👍</span>
                <span class="emoji">👏</span>
                <span class="emoji">🎉</span>
                <span class="emoji">❤️</span>
                <span class="emoji">🔥</span>
                <span class="emoji">💯</span>
            </div>
        </div>
    </div>

    <!-- 消息操作菜单 -->
    <div id="message-menu" class="message-menu" style="display: none;">
        <ul>
            <li id="quote-menu-item"><i class="fas fa-quote-left"></i> 引用</li>
            <li id="delete-menu-item"><i class="fas fa-trash"></i> 删除</li>
            <li id="recall-menu-item"><i class="fas fa-undo"></i> 撤回</li>
        </ul>
    </div>

    <script src="script.js"></script>
</body>
</html>